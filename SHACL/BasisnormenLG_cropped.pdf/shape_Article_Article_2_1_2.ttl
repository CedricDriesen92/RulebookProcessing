@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix fro: <http://www.firebim.org/ontologies/fro#> .
@prefix fbo: <http://www.firebim.org/ontologies/fbo#> .

<https://ontology.firebim.be/ontology/fro#Article_2_1_2>
    a sh:NodeShape ;
    sh:targetClass fro:FireCompartment ;
    sh:severity sh:Violation ;
    sh:message "Article 2.1.2: The height of a compartment must correspond to one storey, unless it meets specific exceptions (Parking, Duplex, Triplex, Technical Room, or Atrium with specific safety systems)."@en ;
    sh:or (
        # General Rule: The height of a compartment corresponds to one storey.
        [
            sh:path fro:numberOfLevels ;
            sh:maxInclusive 1 ;
        ]
        # Exception A: Parking with storeys.
        [
            sh:path fro:usageType ;
            sh:hasValue fro:Parking ;
        ]
        # Exception B: Duplex (2 levels, max 2500 m²).
        [
            a sh:NodeShape ;
            sh:property [
                sh:path fro:numberOfLevels ;
                sh:maxInclusive 2 ;
            ] ;
            sh:property [
                sh:path fro:floorArea ;
                sh:maxInclusive 2500 ;
                sh:datatype xsd:decimal ;
            ] ;
        ]
        # Exception C: Triplex (3 levels, max 300 m², Total Surveillance Detection).
        [
            a sh:NodeShape ;
            sh:property [
                sh:path fro:numberOfLevels ;
                sh:maxInclusive 3 ;
            ] ;
            sh:property [
                sh:path fro:floorArea ;
                sh:maxInclusive 300 ;
                sh:datatype xsd:decimal ;
            ] ;
            sh:property [
                sh:path fro:hasFireDetectionSystem ;
                sh:hasValue fro:TotalSurveillance ;
                sh:message "Triplex compartments must be equipped with automatic fire detection of type 'total surveillance'." ;
            ] ;
        ]
        # Exception D: Compartment containing only technical rooms.
        [
            sh:path fro:usageType ;
            sh:hasValue fro:TechnicalRoom ;
        ]
        # Exception E: Atrium (Requires Automatic Suppression AND Smoke/Heat Extraction).
        [
            a sh:NodeShape ;
            sh:property [
                sh:path fro:hasAutomaticSuppressionSystem ;
                sh:hasValue true ;
                sh:message "Multi-storey atriums must have an automatic suppression system." ;
            ] ;
            sh:property [
                sh:path fro:hasSmokeHeatExtractionSystem ;
                sh:hasValue true ;
                sh:message "Multi-storey atriums must have a smoke and heat extraction system." ;
            ] ;
        ]
    ) .