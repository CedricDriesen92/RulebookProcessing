@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix fro: <http://www.firebim.org/ontologies/fro#> .
@prefix fbo: <http://www.firebim.org/ontologies/fbo#> .
@prefix bot: <https://w3id.org/bot#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

<https://ontology.firebim.be/ontology/fro#Article_2_1_1>
    a sh:NodeShape ;
    rdfs:label "Compartimentering Oppervlakte en Lengte"@nl ;
    rdfs:comment "Regels met betrekking tot de maximale oppervlakte en lengte van brandcompartimenten (Art 2.1.1)."@nl ;
    sh:targetClass fbo:FireCompartment ;
    sh:message "Het compartiment voldoet niet aan de eisen van Artikel 2.1.1 met betrekking tot oppervlakte, lengte of vereiste uitrusting."@nl ;
    sh:or (
        # Exception 1: Parkings (Excluded from this specific rule, referenced in 5.2)
        [
            sh:path fbo:hasFunction ;
            sh:hasValue fbo:ParkingFunction ;
            sh:message "Uitzondering voor parkings."@nl ;
        ]
        # Exception 2: Administrative Derogation (Ministerial exception)
        [
            sh:path fbo:hasDerogation ;
            sh:hasValue true ;
            sh:message "Ministeriële afwijking toegestaan."@nl ;
        ]
        # Exception 3: Equipped with Automatic Extinguishing AND Smoke/Heat Extraction
        # If equipped, the strict area limits of 2500/3500 do not apply (implicit unlimited/higher limit)
        [
            sh:and (
                [
                    sh:path fbo:hasAutomaticFireSuppressionSystem ;
                    sh:hasValue true ;
                ]
                [
                    sh:path fbo:hasSmokeAndHeatExtractionSystem ;
                    sh:hasValue true ;
                ]
            ) ;
            sh:message "Toegestaan wegens aanwezigheid blusinstallatie en RWA."@nl ;
        ]
        # Exception 4: Single-story building with exactly one compartment
        # Max Area: 3500m², Max Length: 90m
        [
            sh:and (
                [
                    # Check context: Building is single storey
                    sh:path fbo:isCompartmentOf ;
                    sh:node [
                        sh:property [
                            sh:path fbo:isSingleStorey ;
                            sh:hasValue true ;
                        ] ;
                        # Check context: Building consists of one compartment
                        sh:property [
                            sh:path fbo:numberOfCompartments ;
                            sh:maxInclusive 1 ;
                        ] ;
                    ]
                ]
                [
                    sh:path fbo:floorArea ;
                    sh:maxInclusive 3500 ;
                    sh:datatype xsd:double ;
                ]
                [
                    sh:path fbo:length ;
                    sh:maxInclusive 90 ;
                    sh:datatype xsd:double ;
                ]
            ) ;
            sh:message "Gelijkvloers gebouw met 1 compartiment: max 3500m² en max 90m lengte."@nl ;
        ]
        # Standard Rule: Max Area 2500m²
        [
            sh:path fbo:floorArea ;
            sh:maxInclusive 2500 ;
            sh:datatype xsd:double ;
            sh:message "Standaard regel: compartiment max 2500m²."@nl ;
        ]
    ) .